<div class="layui-card layadmin-header">

</div>
<div class="layui-fluid">
  <div class="layui-row layui-col-space15">
    <div class="layui-col-md12">
      <div class="layui-card">
        <div class="layui-card-body">
          <form class="layui-form" id="searchForm" style="margin-bottom: 20px;">
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="nick_name" value="" placeholder="nick_name" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="head_icon" value="" placeholder="head_icon" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="sur_name" value="" placeholder="sur_name" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="name" value="" placeholder="name" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="vacation_mode" value="" placeholder="vacation_mode" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="type" value="" placeholder="type" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="auth_state" value="" placeholder="auth_state" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="identity_state" value="" placeholder="identity_state" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="education_state" value="" placeholder="education_state" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="intelligence_state" value="" placeholder="intelligence_state" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="area_code" value="" placeholder="area_code" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="mobile_num" value="" placeholder="mobile_num" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="email" value="" placeholder="email" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="login_name" value="" placeholder="login_name" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="password" value="" placeholder="password" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="pay_password" value="" placeholder="pay_password" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="wechat_openid" value="" placeholder="wechat_openid" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="facebook_openid" value="" placeholder="facebook_openid" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="twitter_openid" value="" placeholder="twitter_openid" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="invite_member" value="" placeholder="invite_member" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="invite_code" value="" placeholder="invite_code" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="languages" value="" placeholder="languages" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="sex" value="" placeholder="sex" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="apptoken" value="" placeholder="apptoken" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="status" value="" placeholder="status" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="invite_num" value="" placeholder="invite_num" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="descriptions" value="" placeholder="descriptions" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="my_scan" value="" placeholder="my_scan" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="registry_way" value="" placeholder="registry_way" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="last_login_device" value="" placeholder="last_login_device" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="balance" value="" placeholder="balance" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="address" value="" placeholder="address" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="accountStatus" value="" placeholder="accountStatus" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="street_name" value="" placeholder="street_name" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="house_number" value="" placeholder="house_number" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="identity_code" value="" placeholder="identity_code" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="sendbird_access_token" value="" placeholder="sendbird_access_token" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="course_time" value="" placeholder="course_time" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="teach_language" value="" placeholder="teach_language" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="wiling_travel" value="" placeholder="wiling_travel" class="layui-input search_input">
            </div>
            <div class="layui-input-inline" style="width:145px; margin: 8px 0 0 0;">
              <input type="text" name="stripe_customer" value="" placeholder="stripe_customer" class="layui-input search_input">
            </div>
            <a class="layui-btn layui-btn-normal" style="margin: 8px 0 0 0" id="search_btn">
              <i class="layui-icon larry-icon">&#xe615;</i>查询
            </a>
            <button type="reset" id="reset_btn" class="layui-btn" style="margin: 8px 0 0 0"><i class="layui-icon larry-icon">&#x1002;</i>
              重置
            </button>
            <% if (modify_permission) { %>
            <a class="layui-btn layui-btn-primary" id="add_btn" style="margin: 8px 0 0 0">
              <i class="layui-icon larry-icon">&#xe654;</i>添加
            </a>
            <% } %>
          </form>
          <table style="margin-top: 20px;" class="layui-hide" id="test-table-form" lay-filter="table"></table>
          <script type="text/html" id="operation">
            <% if (modify_permission) { %>
            <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
            <% } %>
            <% if (delete_permission) { %>
            {{#  if(d.deleted === 0){ }}
            <a class="layui-btn layui-btn-xs layui-btn-danger" lay-event="delete">删除</a>
            {{#  } else { }}
            {{#  } }}
            <% } %>
          </script>
          <script type="text/html" id="deleted">
            {{#  if(d.deleted === 0){ }}
            正常
            {{#  } else { }}
            <span style="color: #F581B1;">已删除</span>
            {{#  } }}
          </script>
        </div>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
  layui.use(['table', 'form'], function () {
    var table = layui.table, form = layui.form, $ = layui.$;
    var tableRender = table.render({
      elem: '#test-table-form',
      url: '/admin/tuex_member/index',
      method: 'post',
      cellMinWidth: 80,
      cols: [[
        {field:'nick_name', title: 'nick_name'},
        {field:'head_icon', title: 'head_icon'},
        {field:'sur_name', title: 'sur_name'},
        {field:'name', title: 'name'},
        {field:'vacation_mode', title: 'vacation_mode'},
        {field:'teacher', title: 'teacher'},
        {field:'type', title: 'type'},
        {field:'auth_state', title: 'auth_state'},
        {field:'identity_state', title: 'identity_state'},
        {field:'education_state', title: 'education_state'},
        {field:'intelligence_state', title: 'intelligence_state'},
        {field:'area_code', title: 'area_code'},
        {field:'mobile_num', title: 'mobile_num'},
        {field:'email', title: 'email'},
        {field:'login_name', title: 'login_name'},
        {field:'password', title: 'password'},
        {field:'pay_password', title: 'pay_password'},
        {field:'wechat_openid', title: 'wechat_openid'},
        {field:'facebook_openid', title: 'facebook_openid'},
        {field:'twitter_openid', title: 'twitter_openid'},
        {field:'invite_member', title: 'invite_member'},
        {field:'invite_code', title: 'invite_code'},
        {field:'languages', title: 'languages'},
        {field:'sex', title: 'sex'},
        {field:'apptoken', title: 'apptoken'},
        {field:'status', title: 'status'},
        {field:'invite_num', title: 'invite_num'},
        {field:'descriptions', title: 'descriptions'},
        {field:'my_scan', title: 'my_scan'},
        {field:'registry_way', title: 'registry_way'},
        {field:'last_login_device', title: 'last_login_device'},
        {field:'balance', title: 'balance'},
        {field:'address', title: 'address'},
        {field:'accountStatus', title: 'accountStatus'},
        {field:'grade', title: 'grade'},
        {field:'province_id', title: 'province_id'},
        {field:'city_id', title: 'city_id'},
        {field:'street_name', title: 'street_name'},
        {field:'house_number', title: 'house_number'},
        {field:'identity_code', title: 'identity_code'},
        {field:'sendbird_access_token', title: 'sendbird_access_token'},
        {field:'course_time', title: 'course_time'},
        {field:'teach_language', title: 'teach_language'},
        {field:'wiling_travel', title: 'wiling_travel'},
        {field:'stripe_customer', title: 'stripe_customer'},
        {field: 'deleted', title: '是否删除', templet: "#deleted"},
        {fixed: 'right', title: '操作', align: 'center', toolbar: '#operation'}
      ]],
      page: true
    });

    $('#add_btn').on('click', function () {
      parent.window.addTab({
        title: '添加Tuex_member',
        href: '/admin/tuex_member/modify'
      });
    });

    $('#search_btn').on('click', function () {
      var obj = {};
      var array = $('#searchForm').serializeArray();
      for (var i = 0; i < array.length; i++) {
        var item = array[i];
        obj[item.name] = item.value;
      }

      tableRender.reload({
        where: obj
      });
    });

    table.on('tool(table)', function(obj) {
      if (obj.event === 'edit') {
        //标签页打开编辑页面
        parent.window.addTab({
          title: '编辑Tuex_member',
          href: '/admin/tuex_member/modify?id=' + obj.data.id
        });
      } else if (obj.event === 'delete') {
        layer.confirm('是否确定删除？', {icon: 3, title: '提示'}, function (index) {
          layer.close(index);
          var loading = layer.load(1);
          $.post('/admin/tuex_member/delete', obj.data, function (data) {
            layer.close(loading);
            if (data.errCode === 0) {
              layer.msg(data.msg, {
                icon: 6,
                time: 1000
              }, function () {

                var obj = {};
                var array = $('#searchForm').serializeArray();

                for (var i = 0; i < array.length; i++) {
                  var item = array[i];
                  obj[item.name] = item.value;
                }
                tableRender.reload({
                  where: obj
                });

              });
            }
            else {
              layer.msg(data.msg, {icon: 5});
            }
          });
        });
      }
    });

  });
</script>
